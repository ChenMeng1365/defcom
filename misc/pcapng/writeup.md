
# pcapng

寻找http并且由47.94.110.102提交的报文, 筛选器`http && ip.src==47.94.110.102`, 按序号排列, 将DATA字段作为列在wireshark中显示出来

```txt
3.130616	134	47.94.110.102	172.23.139.89	HTTP	77	789c333430020001280094	POST /upload/0 HTTP/1.1 
4.768607	267	47.94.110.102	172.23.139.89	HTTP	77	789c3334b00000012e009a	POST /upload/1 HTTP/1.1 
5.581036	336	47.94.110.102	172.23.139.89	HTTP	76	789cb334070000ab0071	POST /upload/2 HTTP/1.1 
5.260990	309	47.94.110.102	172.23.139.89	HTTP	77	789c333430060001290095	POST /upload/3 HTTP/1.1 
6.405232	401	47.94.110.102	172.23.139.89	HTTP	77	789c3334320600012d0097	POST /upload/4 HTTP/1.1 
2.285900	67	47.94.110.102	172.23.139.89	HTTP	77	789c333430000001260092	POST /upload/5 HTTP/1.1 
1.775971	25	47.94.110.102	172.23.139.89	HTTP	76	789c33350400009d0067	POST /upload/6 HTTP/1.1 
2.117307	54	47.94.110.102	172.23.139.89	HTTP	76	789c33350200009e0068	POST /upload/7 HTTP/1.1 
3.779091	188	47.94.110.102	172.23.139.89	HTTP	76	789c33b1040000a3006e	POST /upload/8 HTTP/1.1 
6.767076	429	47.94.110.102	172.23.139.89	HTTP	77	789c333430020001280094	POST /upload/9 HTTP/1.1 
7.471687	485	47.94.110.102	172.23.139.89	HTTP	76	789c33350200009e0068	POST /upload/10 HTTP/1.1 
2.798491	107	47.94.110.102	172.23.139.89	HTTP	76	789c33350000009c0066	POST /upload/11 HTTP/1.1 
4.604843	253	47.94.110.102	172.23.139.89	HTTP	76	789c3335050000a1006b	POST /upload/12 HTTP/1.1 
6.948385	442	47.94.110.102	172.23.139.89	HTTP	77	789c333430040001270093	POST /upload/13 HTTP/1.1 
7.302305	471	47.94.110.102	172.23.139.89	HTTP	76	789c3335050000a1006b	POST /upload/14 HTTP/1.1 
6.245639	387	47.94.110.102	172.23.139.89	HTTP	76	789c3335070000a3006d	POST /upload/15 HTTP/1.1 
1.947373	38	47.94.110.102	172.23.139.89	HTTP	76	789c3335050000a1006b	POST /upload/16 HTTP/1.1 
5.919105	361	47.94.110.102	172.23.139.89	HTTP	76	789c33350200009e0068	POST /upload/17 HTTP/1.1 
7.824099	512	47.94.110.102	172.23.139.89	HTTP	76	789cb3b4000000ac0072	POST /upload/18 HTTP/1.1 
4.930437	280	47.94.110.102	172.23.139.89	HTTP	76	789c33350400009d0067	POST /upload/19 HTTP/1.1 
4.421543	241	47.94.110.102	172.23.139.89	HTTP	76	789c33350400009d0067	POST /upload/20 HTTP/1.1 
2.626641	94	47.94.110.102	172.23.139.89	HTTP	76	789cb334070000ab0071	POST /upload/21 HTTP/1.1 
7.119548	458	47.94.110.102	172.23.139.89	HTTP	76	789c3335030000a2006c	POST /upload/22 HTTP/1.1 
2.958091	120	47.94.110.102	172.23.139.89	HTTP	77	789c333430020001280094	POST /upload/23 HTTP/1.1 
5.755268	349	47.94.110.102	172.23.139.89	HTTP	77	789c333430000001260092	POST /upload/24 HTTP/1.1 
4.098866	213	47.94.110.102	172.23.139.89	HTTP	76	789cb3b4000000ac0072	POST /upload/25 HTTP/1.1 
1.608611	11	47.94.110.102	172.23.139.89	HTTP	76	789c3335030000a2006c	POST /upload/26 HTTP/1.1 
7.645820	498	47.94.110.102	172.23.139.89	HTTP	77	789c333430000001260092	POST /upload/27 HTTP/1.1 
2.447707	80	47.94.110.102	172.23.139.89	HTTP	76	789c33350400009d0067	POST /upload/28 HTTP/1.1 
5.094678	293	47.94.110.102	172.23.139.89	HTTP	76	789c3335030000a2006c	POST /upload/29 HTTP/1.1 
4.261586	227	47.94.110.102	172.23.139.89	HTTP	76	789c3335010000a0006a	POST /upload/30 HTTP/1.1 
6.081073	375	47.94.110.102	172.23.139.89	HTTP	77	789c333430000001260092	POST /upload/31 HTTP/1.1 
3.616969	173	47.94.110.102	172.23.139.89	HTTP	76	789cb334070000ab0071	POST /upload/32 HTTP/1.1 
3.303881	146	47.94.110.102	172.23.139.89	HTTP	76	789c3335030000a2006c	POST /upload/33 HTTP/1.1 
5.420524	323	47.94.110.102	172.23.139.89	HTTP	76	789c3335050000a1006b	POST /upload/34 HTTP/1.1 
3.462538	160	47.94.110.102	172.23.139.89	HTTP	76	789c3335030000a2006c	POST /upload/35 HTTP/1.1 
3.944810	201	47.94.110.102	172.23.139.89	HTTP	77	789c333430020001280094	POST /upload/36 HTTP/1.1 
6.587673	415	47.94.110.102	172.23.139.89	HTTP	77	789c3334320500012f0099	POST /upload/37 HTTP/1.1 
```

由于载荷是加密的, 用zlib解密得到每个报文, 发现每次就是提交一个字符

```ruby
require "zlib"

seq = DATA.read.split("\n").map{|l|l.split("\t")[-2]}

puts seq.map{|s|
    Zlib::Inflate.inflate(s.each_char.each_slice(2).map{|c|eval("0x"+c.join).chr}.join).to_i.chr
}.join # => flag{d341f427e7974b33a8fdb8d386da878f}
```
