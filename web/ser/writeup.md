
# writeup

审计代码发现是反序列化问题, 即构造对象的file属性含有flag.php文件名

此外, 还要通过`/[oc]:\d+:/i`的正则表达式检查

由于序列化对象值为`O:4:"baby":1:{s:4:"file";s:8:"flag.php";}`, 为了不让对象头部匹配正则, 将4前面加个正号, 即`O:+4:"baby":1:{s:4:"file";s:8:"flag.php";}`, 如此可绕开验证

另外注意两点:

一, 请求时要做URL编码  
二, URL编码工具可能改变序列字符串的大小写, 而序列化字符串大小写敏感, O必须为大写, 小写爆不出结果(这里被hackbar狠狠坑了一回)

最后burp修改提交得到

```php
<?php
$flag="flag{d596df748167}";
?>
```
